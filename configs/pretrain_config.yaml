# ==================== 数据配置 ====================
train_data_path: "./datasets/test/test_pre_train.jsonl"  # 训练数据文件路径
eval_data_path: ""                                       # 测试数据文件路径
tokenizer_path: "./tokenizer"                            # 分词器路径
max_length: 512                                          # 输入序列最大长度

# ==================== 优化器配置 ====================
learning_rate: 1e-4                            # 学习率
weight_decay: 0.1                              # 权重衰减系数
adam_epsilon: 1e-8                             # Adam优化器的epsilon参数
max_grad_norm: 1.0                             # 梯度裁剪的最大范数

# ==================== 调度器配置 ====================
warmup_steps: 1000                             # 学习率预热步数
total_steps: 100000                            # 总训练步数
scheduler_type: "cosine"                       # 学习率调度器类型

# ==================== 训练配置 ====================
epochs: 1                                      # 训练轮数
batch_size: 1                                  # 批次大小
gradient_accumulation_steps: 1                 # 梯度累积步数
save_steps: 1000                               # 模型保存步数间隔
log_steps: 100                                 # 日志记录步数间隔
eval_steps: 2000                               # 评估步数间隔
seed: 42                                       # 随机种子

# ==================== 模型配置 ====================
# 模型基本超参数
vocab_size: 64000                              # 词汇表大小
hidden_size: 512                               # 隐藏层维度
num_hidden_layers: 8                           # Transformer层数
hidden_act: "silu"                             # 激活函数类型
intermediate_size: null                        # FFN中间层维度，默认值为hidden_size*4

# 多头注意力层配置
num_attention_heads: 8                         # 注意力头数
num_key_value_heads: 2                         # Key-Value头数（分组查询注意力）
flash_attn: true                               # 是否使用Flash Attention
max_position_embeddings: 32768                 # 最大位置编码长度

# RoPE位置编码配置
rope_theta: 1e6                                # RoPE旋转位置编码的base theta
inference_rope_scaling: false                  # 推理时是否使用RoPE缩放

# 正则化配置
dropout: 0.0                                   # Dropout概率
rms_norm_eps: 1e-05                            # RMSNorm的epsilon参数

# MoE混合专家配置
use_moe: false                                 # 是否使用MoE架构
num_experts_per_tok: 2                         # 每个token使用的专家数
n_routed_experts: 8                            # 路由专家总数
n_shared_experts: 1                            # 共享专家数
scoring_func: "softmax"                        # 专家评分函数类型
aux_loss_alpha: 0.01                           # MoE辅助损失权重
seq_aux: true                                  # 是否使用序列级辅助损失
norm_topk_prob: true                           # 是否对topk概率进行归一化

# 初始化配置
initializer_range: 0.02                        # 参数初始化范围
verbose_init: false                            # 是否打印初始化信息
use_cache: true                                # 是否使用KV缓存加速推理

# 其他超参数配置
pad_token_id: null                             # 填充token ID
bos_token_id: 1                                # 起始token ID
eos_token_id: 2                                # 结束token ID
tie_word_embeddings: false                     # 是否绑定输入输出词嵌入权重

# ==================== 系统配置 ====================
checkpoint_dir: "./checkpoints"                # 检查点保存目录
log_file: "./logs/pretrain.log"                # 日志文件路径
device: "cpu"                                  # 训练设备(cpu/cuda)
mixed_precision: true                          # 是否使用混合精度训练
resume_training: false                         # 是否从检查点恢复训练
num_workers: 4                                 # 数据加载器工作线程数
pin_memory: true                               # 是否将数据加载到固定内存中
drop_last: true                                # 是否丢弃最后一个不完整批次


# ==================== SwanLab配置 ====================
use_swanlab: true                              # 是否使用SwanLab进行实验跟踪
api_key: "your_swanlab_api_key"                # SwanLab API密钥
project: ""                                    # SwanLab项目名称
workspace: ""                                  # SwanLab工作空间名称
experiment_name: "test-pretrain"               # SwanLab实验名称